import React, {
  useState,
  useEffect,
  useMemo,
  useCallback,
  useRef,
} from 'react';
import {
  Settings,
  Download,
  Trash2,
  Plus,
  Sun,
  Moon,
  CreditCard,
} from 'lucide-react';

// NOTE: In a real-world React project, you would install these via npm (npm install jspdf html2canvas).
// For this single-file environment, we assume they are loaded via external scripts in the HTML wrapper.
// The functions are accessed globally: new jsPDF.jsPDF() and window.html2canvas()

/**
 * Utility function to format currency
 * @param {number} amount
 * @returns {string}
 */
const formatCurrency = (amount) => {
  return (amount || 0).toLocaleString('en-US', {
    style: 'currency',
    currency: 'USD',
    minimumFractionDigits: 2,
    maximumFractionDigits: 2,
  });
};

// Initial state for the invoice data
const initialInvoiceData = {
  invoiceNumber: 'INV-2024-001',
  date: new Date().toISOString().substring(0, 10),
  dueDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000)
    .toISOString()
    .substring(0, 10), // 30 days later
  senderName: 'Frontend Pro Solutions',
  senderAddress: '101 React Way, Dev City',
  senderEmail: 'billing@prosolutions.com',
  senderPhone: '+1 555-DEV-PROJ',
  clientName: 'Innovate Global Inc.',
  clientAddress: '200 Design Blvd, Tech Hub',
  clientEmail: 'accounts@innovateglobal.com',
  clientPhone: '+1 555-BUS-ACC',
  items: [
    {
      id: 1,
      description: 'UX/UI Wireframing (Hours)',
      quantity: 20,
      price: 75.0,
    },
    {
      id: 2,
      description: 'React Component Development',
      quantity: 80,
      price: 95.0,
    },
  ],
  taxRate: 7.5, // Percentage
  discount: 0, // Fixed amount discount
  notes:
    'Thank you for choosing Frontend Pro Solutions. Your timely payment is appreciated.',
};

const Header = ({ darkMode, toggleDarkMode }) => {
  const textColor = darkMode ? 'text-gray-100' : 'text-gray-900';
  const iconColor = darkMode ? 'text-indigo-400' : 'text-indigo-600';

  return (
    <header className="flex justify-between items-center p-4 border-b border-gray-700/10">
      <h1 className={`text-2xl font-extrabold ${textColor} flex items-center`}>
        <CreditCard className={`w-6 h-6 mr-3 ${iconColor}`} />
        Invoice Generator
      </h1>